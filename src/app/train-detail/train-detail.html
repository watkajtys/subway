<div class="relative flex min-h-screen w-full flex-col bg-background-light dark:bg-background-dark text-zinc-900 dark:text-white group/design-root overflow-x-hidden" *ngIf="trip() as trip">
  <div class="md:max-w-2xl lg:max-w-4xl mx-auto w-full">
    <!-- Top App Bar -->
    <header class="sticky top-0 z-10 flex items-center bg-background-light/80 dark:bg-background-dark/80 p-4 pb-2 justify-between backdrop-blur-sm">
      <div class="flex size-12 shrink-0 items-center">
        <a routerLink="/" class="material-symbols-outlined text-2xl">arrow_back</a>
      </div>
      <h1 class="flex-1 text-lg text-center font-bold">
        {{ routeId() }} Train to {{ routeId() | destination:direction() }}
      </h1>
      <div class="flex size-12 shrink-0 items-center justify-end">
        <span class="material-symbols-outlined text-2xl">more_vert</span>
      </div>
    </header>

    <!-- Summary Card -->
    <div class="flex items-center gap-4 px-4 py-4">
      <app-route-badge [routeId]="routeId()!" size="large"></app-route-badge>
      <div class="flex flex-col justify-center">
        <p class="text-base font-medium" *ngIf="nextStop()">
          <span *ngIf="isArriving()">Arriving at</span>
          <span *ngIf="!isArriving()">En Route to</span>
          {{ nextStop()?.stopId | stopName }}
        </p>
        <p class="text-sm text-zinc-500 dark:text-zinc-400">
          {{ direction() === 'N' ? 'Uptown' : 'Downtown' }}
        </p>
      </div>
    </div>

    <!-- Stop List -->
    <main class="px-4">
      <ul class="flex flex-col">
        <!-- Past Stops -->
        <li *ngFor="let stop of accumulatedPastStops()" class="flex items-center py-3 border-b border-zinc-200 dark:border-zinc-800 opacity-50">
          <div class="flex items-center space-x-4 flex-1">
            <span class="material-symbols-outlined text-2xl text-zinc-500">check_circle</span>
            <div>
              <p class="font-medium text-base text-zinc-500">{{ stop.stopId | stopName }}</p>
              <div class="flex items-center gap-2 mt-1" *ngIf="getTransfersForStop(stop.stopId!).length > 0 || isAccessible(stop.stopId!)">
                <span class="material-symbols-outlined text-lg" title="Accessibility" *ngIf="isAccessible(stop.stopId!)">accessible</span>
                <div class="flex items-center gap-1.5 flex-wrap">
                  <app-route-badge *ngFor="let route of getTransfersForStop(stop.stopId!)" [routeId]="route"></app-route-badge>
                </div>
              </div>
            </div>
          </div>
        </li>

        <!-- Upcoming Stops -->
        <li *ngFor="let stop of futureStops(); let i = index" class="flex items-center justify-between py-3 border-b border-zinc-200 dark:border-zinc-800 cursor-pointer hover:bg-zinc-100 dark:hover:bg-zinc-900" (click)="onStationClick(stop.stopId!)">
          <div class="flex items-center space-x-4">
            <span class="material-symbols-outlined text-2xl" [class.text-primary]="i === 0" [class.text-zinc-400]="i > 0">
              {{ i === 0 ? 'adjust' : 'radio_button_unchecked' }}
            </span>
            <div>
              <p class="font-medium text-base">{{ stop.stopId | stopName }}</p>
              <div class="flex items-center gap-2 mt-1" *ngIf="getTransfersForStop(stop.stopId!).length > 0 || isAccessible(stop.stopId!)">
                <span class="material-symbols-outlined text-lg" title="Accessibility" *ngIf="isAccessible(stop.stopId!)">accessible</span>
                <div class="flex items-center gap-1.5 flex-wrap">
                  <app-route-badge *ngFor="let route of getTransfersForStop(stop.stopId!)" [routeId]="route"></app-route-badge>
                </div>
              </div>
            </div>
          </div>
          <p class="font-bold text-lg" [ngStyle]="getTimeStyles(stop.arrival?.time)">
            {{ stop.arrival?.time | arrivalTime }}
          </p>
        </li>
      </ul>
    </main>
  </div>
</div>
